{% extends "base.html" %}
{% block content %}

<h3>{{ movie.title }} {% if movie.year %}<span class="mini">({{ movie.year }})</span>{% endif %}</h3>

<div class="controls" style="align-items:flex-start;">
  <div style="max-width:260px;">
    {% if movie.poster_path %}
      <img class="poster" src="{{ url_for('poster', size='w342', tmdb_id=movie.tmdb_id) }}" alt="Poster for {{ movie.title }}">
    {% endif %}
  </div>

  <div style="flex:1; min-width:240px;">
    <p class="mini" style="margin-top:0;">
      ★ {{ "%.1f"|format(movie.vote_avg or 0) }} ({{ movie.vote_count or 0 }}) ·
      {{ movie.runtime or "—" }} min
    </p>

    <p class="mini" style="margin:0 0 12px 0;">
      <a href="https://www.justwatch.com/us/search?q={{ movie.title|urlencode }}" target="_blank" rel="noopener">JustWatch</a>
      ·
      <a href="http://nas.phfactor.net:8310/add/new?term={{ movie.title|urlencode }}" target="_blank" rel="noopener">Local</a>
    </p>

    {% if directors %}
      <p><b>Director{% if directors|length > 1 %}s{% endif %}:</b>
      {% for d in directors %}
        <span class="badge">
          {{ d.name }}
          {% if d.gender == 1 %}· woman{% elif d.gender == 2 %}· man{% elif d.gender == 3 %}· non-binary{% endif %}
        </span>
      {% endfor %}
      </p>
    {% endif %}

    {% if movie.overview %}
      <p>{{ movie.overview }}</p>
    {% endif %}

    <form method="post" action="{{ url_for('selection_action') }}" class="controls">
      <input type="hidden" name="csrf" value="{{ csrf_token }}">
      <input type="hidden" name="return_to" value="{{ request.path }}">
      <input type="hidden" name="pick" value="{{ movie.tmdb_id }}">
      <button name="action" value="add_to_basket">Add to basket</button>
      <button name="action" value="remove_from_basket">Remove from basket</button>
    </form>
  </div>
</div>

{% endblock %}
