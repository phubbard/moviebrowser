{% extends "base.html" %}
{% block content %}
<h3>Selected movies</h3>
<p class="mini">
  This is a filtered view of only the IDs you just checked (page-only selection).
  ·
  <a href="{{ toggle_plots_url }}">{% if show_plots %}Hide plots{% else %}Show plots{% endif %}</a>
</p>

{% if movies %}
  <div class="grid">
    {% for m in movies %}
      <div class="card">
        {% if m.poster_path %}
          <a href="{{ url_for('movie', tmdb_id=m.tmdb_id) }}">
            <img class="poster" loading="lazy"
                 src="{{ url_for('poster', size='w342', tmdb_id=m.tmdb_id) }}"
                 alt="Poster for {{ m.title }}">
          </a>
        {% endif %}
        <p style="margin:8px 0 4px 0;"><b>{{ m.title }}</b></p>
        <p class="mini" style="margin:0;">
          {{ m.year or "—" }} · ★ {{ "%.1f"|format(m.vote_avg or 0) }} ({{ m.vote_count or 0 }})
        </p>
        {% if show_plots and m.overview %}
        <p class="mini" style="margin:8px 0; line-height:1.4;">
          {{ m.overview }}
        </p>
        {% endif %}
        {% if search_links %}
        <p class="mini" style="margin:4px 0 0 0;">
          {% for link in search_links %}
            {% if not loop.first %}·{% endif %}
            <a href="{{ link.url_template.replace('{title}', m.title|urlencode) }}" target="_blank" rel="noopener">{{ link.label }}</a>
          {% endfor %}
        </p>
        {% endif %}
      </div>
    {% endfor %}
  </div>
{% else %}
  <p>No movies selected.</p>
{% endif %}

<p class="mini" style="margin-top:16px;"><a href="{{ return_to }}">Back to browse</a></p>
{% endblock %}
